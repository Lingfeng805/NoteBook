# 训练模型

- 【1】启动`Visdom`服务:

  ```python
  # cmd命令行
  python -m visdom.server
  ```

- 【2】运行脚本`main.py`:

  重要参数：

  - `--model` 指定模型(e.g. 'svm', 'nn', 'hamida', 'lee', 'chen', 'li')
  - `--dataset`指定要使用的数据集（e.g. 'PaviaC', 'PaviaU', 'IndianPines', 'KSC', 'Botswana'）
  - `--cuda`开关在GPU上运行神经网络。如果未指定此开关，该工具将在CPU上回退。

  例子：

  ```python
  `python main.py --model SVM --dataset IndianPines --training_sample 0.3`
  # 在IndianPines数据集上的SVM上运行网格搜索，使用30%的样本进行训练，其余样本进行测试。结果显示在visdom面板中。
  ```

  ```python
  `python main.py --model nn --dataset PaviaU --training_sample 0.1 --cuda 0`
  # 这是用PaviaU数据集在GPU上运行的一个基本的4层完全连接的神经网络，使用10%的样本进行训练。
  ```

  ```python
  `python main.py --model hamida --dataset PaviaU --training_sample 0.5 --patch_size 7 --epoch 50 --cuda 0` 
  # 利用hamida模型，PaviaU数据集，GPU上运行，3D CNN，在面片大小为7，使用50%的样本进行50个时代的训练和优化。
  ```

- 【3】这样得到的模型输入维度仍然为**1057×960×176**；想办法将1057固定。（读取RAW时只利用1048×960×176的维度信息，制作gt时制作1048×960×176的维度标签），后续测试集输入的维度也按该维度输入。**至此便得到输入维度为1048×960×176的经过训练的模型参数**，存放在`checkpoints`目录下的`.pth`文件。